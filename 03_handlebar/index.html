<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handlebar</title>
    <style>

    </style>
</head>
<body>
    <h1>Handlebar</h1>

    <section class="container">

    </section>
    <script type="myTemplate" id="listTemplate">
    <li>
        <div>게시자 : {{name}}</div>
        <div class="content">{{content}}</div>
        
        <!-- <div>좋아요 갯수 <span> {{like}} </span></div> -->
        {{#isHot like}}{{/isHot}}

        <div class="comment">
            {{#if comment}}
                {{#each comment}}
                <div>{{math @index "+" 1}} {{this}}</div>
                {{/each}}
            {{else}}
                <div>Not yet</div>
            {{/if}}
        </div>

        <hr />

    </li>
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.6/handlebars.min.js"></script>
<script>
    Handlebars.registerHelper("math", function(lvalue, operator, rvalue, options) {
        lvalue = parseFloat(lvalue);
        rvalue = parseFloat(rvalue);
            
        return {
            "+": lvalue + rvalue,
            "-": lvalue - rvalue,
            "*": lvalue * rvalue,
            "/": lvalue / rvalue,
            "%": lvalue % rvalue
        }[operator];
    });

    Handlebars.registerHelper("isHot", (cnt) => {
        if(cnt >= 5) return `HOT!! ${cnt} comments are here`;
        if(cnt >= 3) return `COOL!! ${cnt} comments`;
        return cnt + " comments";
    });

    var data = {
        "id" : 88,
        "name" : "crong",
        "content" : "새로운글을 올렸어요",
        "like" : 5, 
        "comment" : ["댓글이다", "this is reply", "hello handlebars"]
    };
  
    var data2 = [
        {"id" : 88, "name" : "crong", "content" : "새로운글을 올렸어요", "like" : 5, "comment" : ["댓글이다", "잘했어요"]},
        {"id" : 28, "name" : "hary", "content" : "전 오늘도 노래를 불렀어요", "like" : 0, "comment" : ["제발고만..","듣고싶네요 그노래"]},
        {"id" : 23, "name" : "pororo", "content" : "크롱이 항상 말썽을 피워서 행복해~", "like" : 4, "comment" : []},
        {"id" : 5, "name" : "pobi", "content" : "물고기를 한마리도 잡지 못하다니..", "like" : 5, "comment" : ["댓글이다", "멋진글이네요", "잘봤습니다"]}
    ];
  
    let bindTemplate = Handlebars.compile(document.querySelector('#listTemplate').innerText);
    
    document.querySelector('.container').innerHTML = bindTemplate(data);
    document.querySelector('.container').innerHTML += data2.reduce((prv, nxt) => {
        return prv + bindTemplate(nxt);
    }, "");
</script>	
</body>
</html>